{"ast":null,"code":"import React from'react';import logo42 from'./assets/images/logo-42.png';import darklogo42 from'./assets/images/42-dark-logo.png';import'./assets/styles/navbar.css';import{Link}from'react-router-dom';import{isThemeSet}from'./choose_theme';import{useState,useEffect}from'react';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const isLightTheme=isThemeSet();function useIsLogged(){const[sessionData,setSessionData]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{let isMounted=true;const fetchDatabase=async()=>{try{const response=await fetch('http://localhost:8081/database',{method:'GET',headers:{'db_password':'strongpassword'}});if(!response.ok){throw new Error('Erreur lors de la récupération des données');}const database=await response.json();const cookies=document.cookie;let cookieFound=cookies.split(';').find(el=>el.trim().split('=')[0]===\"session_id\");let session_id;if(cookieFound){session_id=cookieFound.split(\"=\")[1];}if(isMounted&&database[\"sessions\"]&&session_id&&database[\"sessions\"][session_id]){setSessionData(database[\"sessions\"][session_id]);}else{setSessionData(null);}setLoading(false);}catch(err){if(isMounted){setError(err.message);setLoading(false);}}};fetchDatabase();return()=>{isMounted=false;};},[]);return{sessionData,loading,error};}export function NavBar(){return/*#__PURE__*/_jsxs(\"nav\",{id:isLightTheme?'navBarLight':'navBar',children:[/*#__PURE__*/_jsx(Link,{to:\"/actions\",children:/*#__PURE__*/_jsx(\"div\",{children:\"Webserv\"})}),/*#__PURE__*/_jsx(LoginLink,{}),/*#__PURE__*/_jsx(Link,{to:\"https://42.fr/en/homepage/\",children:/*#__PURE__*/_jsx(\"img\",{id:\"navLogo\",src:isLightTheme?darklogo42:logo42,alt:\"logo-42\"})})]});}function LoginLink(){const{sessionData}=useIsLogged();if(!sessionData){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsx(Link,{to:\"/login\",children:/*#__PURE__*/_jsx(\"div\",{id:\"signInDiv\",children:\"Sign in\"})})});}else{return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Hello \",sessionData]}),/*#__PURE__*/_jsx(LogOut,{})]});}}function LogOut(){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"form\",{method:\"POST\",action:\"/logout\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"hidden\",name:\"unset-cookie\",value:\"session-id\"}),/*#__PURE__*/_jsx(\"button\",{id:isLightTheme?'logOutBtnLight':'logOutBtnm',type:\"submit\",children:\"Log out\"})]})});}","map":{"version":3,"names":["React","logo42","darklogo42","Link","isThemeSet","useState","useEffect","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","isLightTheme","useIsLogged","sessionData","setSessionData","loading","setLoading","error","setError","isMounted","fetchDatabase","response","fetch","method","headers","ok","Error","database","json","cookies","document","cookie","cookieFound","split","find","el","trim","session_id","err","message","NavBar","id","children","to","LoginLink","src","alt","LogOut","action","type","name","value"],"sources":["/tmp/Webserv/website/src/navbar.js"],"sourcesContent":["import React from 'react';\nimport logo42 from './assets/images/logo-42.png';\nimport darklogo42 from './assets/images/42-dark-logo.png';\nimport './assets/styles/navbar.css'\nimport { Link } from 'react-router-dom';\nimport {isThemeSet} from './choose_theme';\nimport { useState, useEffect } from 'react';\n\n\nconst isLightTheme = isThemeSet();\n\nfunction useIsLogged() {\n    const [sessionData, setSessionData] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n\n    useEffect(() => {\n        let isMounted = true;\n\n        const fetchDatabase = async () => {\n            try {\n                const response = await fetch('http://localhost:8081/database', {\n                    method: 'GET',\n                    headers: {\n                        'db_password': 'strongpassword',\n                    },\n                });\n\n                if (!response.ok) {\n                    throw new Error('Erreur lors de la récupération des données');\n                }\n\n                const database = await response.json();\n\n                const cookies = document.cookie;\n                let cookieFound = cookies.split(';').find(el => el.trim().split('=')[0] === \"session_id\");\n                let session_id;\n                if (cookieFound) {\n                    session_id = cookieFound.split(\"=\")[1];\n                }\n\n                if (isMounted && database[\"sessions\"] && session_id && database[\"sessions\"][session_id]) {\n                    setSessionData(database[\"sessions\"][session_id]);\n                } else {\n                    setSessionData(null);\n                }\n                setLoading(false);\n\n            } catch (err) {\n                if (isMounted) {\n                    setError(err.message);\n                    setLoading(false);\n                }\n            }\n        };\n\n        fetchDatabase();\n\n        return () => {\n            isMounted = false;\n        };\n    }, []);\n\n    return { sessionData, loading, error };\n}\n\nexport function NavBar()\n{\n\treturn (\n\t\t<nav id={isLightTheme ? 'navBarLight' : 'navBar'} >\n\t\t\t<Link to=\"/actions\">\n\t\t\t\t<div>Webserv</div>\n\t\t\t</Link>\n\t\t\t<LoginLink />\n\t\t\t<Link to=\"https://42.fr/en/homepage/\">\n\t\t\t\t<img id='navLogo' src={isLightTheme ? darklogo42 : logo42} alt='logo-42'></img>\n\t\t\t</Link>\n\t\t</nav>\n\t)\n}\n\nfunction LoginLink()\n{\n\tconst { sessionData } = useIsLogged();\n\tif (!sessionData)\n\t{\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Link to=\"/login\">\n\t\t\t\t\t<div id='signInDiv'>Sign in</div>\n\t\t\t\t</Link>\n\t\t\t</>\n\t\t)\n\t}\n\telse\n\t{\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div>Hello {sessionData}</div>\n\t\t\t\t<LogOut />\n\t\t\t</>\n\t\t)\n\t}\n}\n\nfunction LogOut()\n{\n\treturn (\n\t\t<>\n\t\t<form method=\"POST\" action='/logout'>\n\t\t\t<input type=\"hidden\" name=\"unset-cookie\" value=\"session-id\" />\n\t\t\t<button id={isLightTheme ? 'logOutBtnLight' : 'logOutBtnm'} type=\"submit\">Log out</button>\n\t\t</form>\n\t\t</>\n\t)\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}